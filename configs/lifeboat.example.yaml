# TTS Lifeboat Configuration v0.1.5
# =================================
# Created by Kannan
#
# Place this file as 'lifeboat.yaml' in the same directory as the lifeboat executable.
# The lifeboat executable should be placed in your BACKUP folder, not the webapps folder.
#
# Example folder structure:
#   C:\TTS\MyApp\
#   ├── backup\                    <- Put lifeboat.exe and lifeboat.yaml HERE
#   │   ├── lifeboat.exe
#   │   └── lifeboat.yaml
#   └── Tomcat\
#       └── webapps\               <- Reference this path below
#           ├── MyApp.war
#           └── MyApp\

# ===================
# INSTANCE SETTINGS
# ===================

# Name for this Tomcat instance (used in logs and metadata)
name: "My-Webapp"

# Environment tag (for your reference: dev, staging, production)
environment: "production"

# ===================
# PATH CONFIGURATION
# ===================

# REQUIRED: Full path to your Tomcat webapps directory
# Both slash types are supported:
#   - Windows: "C:/TTS/MyApp/Tomcat/webapps" (recommended)
#   - Windows: "C:\\TTS\\MyApp\\Tomcat\\webapps" (also works)
#   - Linux: "/opt/tomcat/webapps"
webapps_path: "C:/TTS/MyApp/Tomcat/webapps"

# Backup destination (. = same folder as lifeboat.exe)
backup_path: "."

# ===================
# WEBAPPS TO BACKUP
# ===================

# List specific webapps to backup.
# Leave empty [] to backup ALL webapps in the webapps_path.
# Include both .war files AND extracted folders if you want both.
webapps:
  # - "MyApp.war"
  # - "MyApp"
  # - "AnotherApp.war"
  # - "AnotherApp"

# ===================
# CUSTOM FOLDERS
# ===================

# Additional folders to backup alongside webapps.
# Use 'required: true' if backup should fail when folder is missing.
# Use 'required: false' to skip if folder doesn't exist.
custom_folders:
  # - title: "Tomcat Config"
  #   path: "C:/TTS/MyApp/Tomcat/conf"
  #   required: true
  #
  # - title: "Application Logs"
  #   path: "C:/TTS/MyApp/Tomcat/logs"
  #   required: false
  #   include:
  #     - "catalina.*.log"
  #
  # - title: "Shared Configs"
  #   path: "C:/TTS/shared-config"
  #   required: false

# ===================
# RETENTION POLICY
# ===================

retention:
  # Enable/disable automatic cleanup
  enabled: true

  # Delete backups older than this many days
  days: 30

  # Always keep at least this many backups (regardless of age)
  min_keep: 5

# ===================
# 7-ZIP SETTINGS
# ===================
# TTS Lifeboat uses external 7-Zip for compression.
# This provides better compression and lower memory usage.

seven_zip:
  # Path to 7z.exe (leave empty to auto-detect)
  # Auto-detects from:
  #   - C:\Program Files\7-Zip\7z.exe
  #   - C:\Program Files (x86)\7-Zip\7z.exe
  #   - System PATH
  path: ""

  # Compression level (0-9)
  # 0 = Store (no compression)
  # 1-3 = Fast
  # 5 = Normal (default, good balance)
  # 7-9 = Maximum (slower but smaller)
  level: 5

  # Number of CPU threads to use
  # 1 = Single thread (low memory, slower)
  # 0 = Auto (all cores)
  threads: 1

# ===================
# COMPRESSION
# ===================
# v0.1.6+: Pure Go streaming compression (no external dependencies on modern builds)
# Modern builds (.tar.zst): Fast, best compression, low memory (~2-5MB RAM)
# Legacy builds (.7z): Uses external 7-Zip (install from 7-zip.org)
#
# Output formats by build:
#   Modern (Go 1.23+):  .tar.zst (extractable with 7-Zip v21.01+, WinRAR v6.10+)
#   Legacy (Go 1.20):   .7z (requires 7-Zip installed)
#   Fallback:           .zip (universal compatibility)

compression:
  enabled: true
  # Compression level (1-9): 1=fastest, 5=balanced, 9=best compression
  level: 5

  # Files with these extensions are already compressed
  # and will be stored without re-compression
  skip_extensions:
    - ".war"
    - ".jar"
    - ".zip"
    - ".gz"
    - ".tar.gz"
    - ".tgz"
    - ".7z"
    - ".rar"
    - ".zst"
    - ".tar.zst"

# ===================
# LOGGING
# ===================

logging:
  # Log file path (relative to lifeboat.exe location)
  path: "./logs/lifeboat.log"

  # Log level: debug, info, warn, error
  level: "info"

  # Maximum log file size
  max_size: "10MB"

  # Maximum number of log files to keep
  max_files: 5

# ===================
# TIPS
# ===================
#
# 1. PREREQUISITES:
#    Modern build (v0.1.6+): No external dependencies!
#    Legacy build: Install 7-Zip from https://www.7-zip.org/
#
# 2. EXTRACTING BACKUPS:
#    .tar.zst files can be extracted with:
#    - 7-Zip (v21.01+): Right-click > 7-Zip > Extract
#    - WinRAR (v6.10+): Right-click > Extract
#    - Linux: tar -xf backup.tar.zst
#
# 3. QUICK START:
#    - Set 'name' to identify this instance
#    - Set 'webapps_path' to your Tomcat webapps folder
#    - Run: lifeboat config validate
#    - Run: lifeboat backup --dry-run
#    - Run: lifeboat backup --all
#
# 3. INTERACTIVE MODE:
#    Just run 'lifeboat' (without arguments) for interactive UI
#    - Select webapps before backup
#    - View backup history
#    - Restore and cleanup
#
# 4. CHECKPOINT BACKUPS:
#    Create important backups that never auto-delete:
#    lifeboat backup --checkpoint --note "Release v2.0"
#
# 5. AUTOMATION:
#    Schedule with cron or Task Scheduler:
#    lifeboat backup --all --note "Scheduled backup"
#
# 6. RESTORE:
#    lifeboat list              # See available backups
#    lifeboat restore latest    # Restore most recent
#
# 7. CLEANUP:
#    lifeboat cleanup           # Preview deletions
#    lifeboat cleanup --force   # Actually delete
